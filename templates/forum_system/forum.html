<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Forum</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/forum.css' %}">
</head>

<body>
    <div class="top-panel">
        <!-- Левая секция -->
        <div class="left-section">
            <a href="{% url 'index' %}">
                <button class="panel-button"><b>Головна</b></button>
            </a>
        </div>
    
        <!-- Центральная секция -->
        <div class="center-section">
            <a href="{% url 'forum' %}">
                <button class="panel-button"><b>Форум</b></button>
            </a>
            <a href="{% url 'events-list' %}">
                <button class="panel-button"><b>Події</b></button>
            </a>
            <div class="dropdown">
                <input type="checkbox" id="toggle" class="dropdown-toggle">
                <label for="toggle" class="panel-button dropdown-label">
                    <b>Інше</b>
                    <span class="arrow">▼</span>
                </label>
                <div class="dropdown-menu">
                    <button class="small-button">Кнопка</button>
                    <button class="small-button">Кнопка</button>
                    <button class="small-button">Кнопка</button>
                </div>
            </div>
        </div>
    
        <!-- Правая секция -->
        <div class="right-section">
            <a href="{% url 'login' %}" class="login-button"><b>Логін</b></a>
            <a href="{% url 'register' %}" class="register-button"><b>Реєстрація</b></a>
        </div>
    </div>
</body>

{% block content %}
<div class="forums-container">
    <!-- Блок категорий -->
    <div class="forums-block">
        <h2 class="forums-block-title">Категорії</h2>
        {% if categories %}
        {% for category in categories %}
        <a href="{% url 'category-detail' category.id %}" class="forums-category-item">
            <div class="forums-category-item-title">{{ category.name }}</div>
            <p class="forums-category-item-description">{{ category.description }}</p>
        </a>
        {% endfor %}
        {% else %}
        <p>Не має доступних категорій.</p>
        {% endif %}
    </div>

    <!-- Блок тем -->
    <div class="forums-block">
        <button class="forums-create-topic-btn" id="create-topic-btn">
            <span class="forums-create-topic-icon" id="create-topic-icon">+</span>
            Створити нову тему
        </button>
        {% if topics %}
        {% for topic in topics %}
        <div class="forums-topic-item">
            <a href="{% url 'topic-detail' topic.id %}" class="forums-topic-item-title">{{ topic.title }}</a>
            <p class="forums-topic-item-description">{{ topic.content|truncatewords:20 }}</p>
            <p class="forums-topic-item-likes">Вподобати: {{ topic.likes_count }}</p>
            <p class="forums-topic-item-date">Створено: {{ topic.created_at }}</p>
        </div>
        {% endfor %}
        {% else %}
        <p>Немає тем для обговорення в цій категорії.</p>
        {% endif %}
    </div>
</div>

<script>
    const createTopicBtn = document.getElementById('create-topic-btn');
    const createTopicIcon = document.getElementById('create-topic-icon');
    
    // Флаг, указывающий, идет ли сейчас анимация
    let isRotating = false;
    
    // Анимация вращения при наведении мыши
    createTopicBtn.addEventListener('mouseenter', () => {
        if (!isRotating) {
            isRotating = true;
            createTopicIcon.classList.add('rotating');
        }
    });
    
    createTopicIcon.addEventListener('animationend', () => {
        isRotating = false;
        createTopicIcon.classList.remove('rotating');
    });
    
    // Обработка клика, перенаправление по адресу
    createTopicBtn.addEventListener('click', () => {
        window.location.href = "{% url 'create-topic' %}";
    });
    </script>
{% endblock %}

